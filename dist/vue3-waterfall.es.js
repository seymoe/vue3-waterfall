var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,r,l)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[r]=l,o=(e,o)=>{for(var a in o||(o={}))r.call(o,a)&&i(e,a,o[a]);if(t)for(var a of t(o))l.call(o,a)&&i(e,a,o[a]);return e};import{defineComponent as a,reactive as n,watch as h,nextTick as s,onMounted as c,onUnmounted as d,toRefs as f,pushScopeId as g,popScopeId as p,openBlock as u,createBlock as w,Fragment as m,renderList as b,renderSlot as v,createVNode as y,toDisplayString as _,withScopeId as x}from"vue";var W=a({name:"VueWaterfall",props:{width:Number,height:Number,colWidth:Number,cols:Number,gap:{type:Number,default:0},footerHeight:{type:Number,default:80},list:{type:Array,default:()=>[]}},setup(e){const t=n({containerWidth:e.width||0,colW:e.colWidth||240,colCount:e.cols||0,beginIndex:0,heightArr:[],waterfallList:[]}),r=()=>{if(!e.width){const e=document.querySelector("#waterfallBox");e&&(t.containerWidth=e.offsetWidth)}if(e.cols?t.colW=Math.floor(t.containerWidth/e.cols-e.gap):t.colCount=Math.floor(t.containerWidth/(t.colW+e.gap)),0===t.beginIndex){t.waterfallList=[],t.heightArr=new Array(t.colCount);for(let e=0;e<t.heightArr.length;e++)t.heightArr[e]=0}l()},l=()=>{for(let r=t.beginIndex;r<e.list.length;r++){const l=e.list[r];let o=new Image;o.src=l.imgSrc,o.onload=o.onerror=r=>{const a=i();l._width=t.colW,l._height=t.colW*o.height/o.width+e.footerHeight,l._top=t.heightArr[a],l._left=a*(l._width+e.gap),t.heightArr[a]+=l._height,t.waterfallList.push(l)}}t.beginIndex=t.waterfallList.length},i=()=>{const e=Math.min.apply(null,t.heightArr);return t.heightArr.indexOf(e)},a=()=>{t.beginIndex=0,r()};return h((()=>e.list),((e,t)=>{(!t||!t.length&&e.length)&&s((()=>{r()}))}),{immediate:!0}),c((()=>{window.addEventListener("resize",a)})),d((()=>{window.removeEventListener("resize",a)})),o(o({},f(t)),f(e))}});const A=x("data-v-011dc47e");g("data-v-011dc47e");const I={class:"vue3-waterfall",id:"waterfallBox"},L={class:"vue3-waterfall-item_footer"},O={class:"title"},N={class:"info"};p();const j=A(((e,t,r,l,i,o)=>(u(),w("div",I,[(u(!0),w(m,null,b(e.waterfallList,((t,r)=>(u(),w("div",{key:r,class:"vue3-waterfall-item",style:{top:t._top+"px",left:t._left+"px",width:t._width+"px",height:t._height+"px"}},[v(e.$slots,"default",{item:t},(()=>[y("img",{src:t._src,alt:t.title},null,8,["src","alt"])]),!0),y("div",L,[v(e.$slots,"footer",{item:t},(()=>[y("p",O,_(t.title),1),y("p",N,_(t.info),1)]),!0)])],4)))),128))]))));W.render=j,W.__scopeId="data-v-011dc47e";export default W;
