var t=Object.defineProperty,e=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(e,l,r)=>l in e?t(e,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[l]=r,o=(t,o)=>{for(var a in o||(o={}))l.call(o,a)&&i(t,a,o[a]);if(e)for(var a of e(o))r.call(o,a)&&i(t,a,o[a]);return t};import{defineComponent as a,reactive as n,watch as h,nextTick as s,onMounted as d,onUnmounted as c,toRefs as f,pushScopeId as g,popScopeId as p,openBlock as u,createBlock as m,Fragment as w,renderList as b,renderSlot as v,createVNode as y,toDisplayString as x,withScopeId as W}from"vue";var A=a({name:"VueWaterfall",props:{width:Number,height:Number,imgWidth:Number,cols:Number,gap:{type:Number,default:0},footerHeight:{type:Number,default:80},option:{type:Object,default:{value:"value",label:"label"}},list:{type:Array,default:()=>[]}},setup(t){const e=n({containerWidth:t.width||0,colWidth:t.imgWidth||240,colCount:t.cols||0,beginIndex:0,heightArr:[],waterfallList:[]}),l=()=>{if(!t.width){const t=document.querySelector("#waterfallBox");t&&(e.containerWidth=t.offsetWidth)}if(t.cols?e.colWidth=Math.floor(e.containerWidth/t.cols-t.gap):e.colCount=Math.floor(e.containerWidth/(e.colWidth+t.gap)),0===e.beginIndex){e.waterfallList=[],e.heightArr=new Array(e.colCount);for(let t=0;t<e.heightArr.length;t++)e.heightArr[t]=0}r()},r=()=>{for(let l=e.beginIndex;l<t.list.length;l++){let r=new Image;r.src=t.list[l].imgSrc,r.onload=r.onerror=a=>{let n=o({width:e.colWidth,height:e.colWidth/r.width*r.height+t.footerHeight,src:t.list[l].imgSrc},t.list[l]);e.waterfallList.push(n),i(n)}}e.beginIndex=e.waterfallList.length},i=l=>{const r=a();l.top=e.heightArr[r],l.left=r*(l.width+t.gap),e.heightArr[r]+=l.height},a=()=>{const t=Math.min.apply(null,e.heightArr);return e.heightArr.indexOf(t)},g=()=>{e.beginIndex=0,l()};return h((()=>t.list),((t,e)=>{(!e||!e.length&&t.length)&&s((()=>{l()}))}),{immediate:!0}),d((()=>{window.addEventListener("resize",g)})),c((()=>{window.removeEventListener("resize",g)})),o(o({},f(e)),f(t))}});const I=W("data-v-4d34081c");g("data-v-4d34081c");const O={class:"vue3-waterfall",id:"waterfallBox"},L={class:"vue3-waterfall-item_footer"},N={class:"title"},j={class:"info"};p();const S=I(((t,e,l,r,i,o)=>(u(),m("div",O,[(u(!0),m(w,null,b(t.waterfallList,((e,l)=>(u(),m("div",{key:l,class:"vue3-waterfall-item",style:{top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px"}},[v(t.$slots,"default",{item:e},(()=>[y("img",{src:e.src,alt:e.title},null,8,["src","alt"]),y("div",L,[v(t.$slots,"footer",{item:e},(()=>[y("p",N,x(e.title),1),y("p",j,x(e.info),1)]),!0)])]),!0)],4)))),128))]))));A.render=S,A.__scopeId="data-v-4d34081c";export default A;
