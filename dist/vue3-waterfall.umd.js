var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e};!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["vue3-waterfall"]=t(e.Vue)}(this,(function(e){"use strict";var t=e.defineComponent({name:"VueWaterfall",props:{width:Number,height:Number,imgWidth:Number,cols:Number,gap:{type:Number,default:0},footerHeight:{type:Number,default:80},option:{type:Object,default:{value:"value",label:"label"}},list:{type:Array,default:()=>[]}},setup(t){const r=e.reactive({containerWidth:t.width||0,colWidth:t.imgWidth||240,colCount:t.cols||0,beginIndex:0,heightArr:[],waterfallList:[]}),o=()=>{if(!t.width){const e=document.querySelector("#waterfallBox");e&&(r.containerWidth=e.offsetWidth)}if(t.cols?r.colWidth=Math.floor(r.containerWidth/t.cols-t.gap):r.colCount=Math.floor(r.containerWidth/(r.colWidth+t.gap)),0===r.beginIndex){r.waterfallList=[],r.heightArr=new Array(r.colCount);for(let e=0;e<r.heightArr.length;e++)r.heightArr[e]=0}l()},l=()=>{for(let e=r.beginIndex;e<t.list.length;e++){let o=new Image;o.src=t.list[e].imgSrc,o.onload=o.onerror=l=>{let a=__spreadValues({width:r.colWidth,height:r.colWidth/o.width*o.height+t.footerHeight,src:t.list[e].imgSrc},t.list[e]);r.waterfallList.push(a),i(a)}}r.beginIndex=r.waterfallList.length},i=e=>{const o=a();e.top=r.heightArr[o],e.left=o*(e.width+t.gap),r.heightArr[o]+=e.height},a=()=>{const e=Math.min.apply(null,r.heightArr);return r.heightArr.indexOf(e)},n=()=>{r.beginIndex=0,o()};return e.watch((()=>t.list),((t,r)=>{(!r||!r.length&&t.length)&&e.nextTick((()=>{o()}))}),{immediate:!0}),e.onMounted((()=>{window.addEventListener("resize",n)})),e.onUnmounted((()=>{window.removeEventListener("resize",n)})),__spreadValues(__spreadValues({},e.toRefs(r)),e.toRefs(t))}});const r=e.withScopeId("data-v-4d34081c");e.pushScopeId("data-v-4d34081c");const o={class:"vue3-waterfall",id:"waterfallBox"},l={class:"vue3-waterfall-item_footer"},i={class:"title"},a={class:"info"};e.popScopeId();const n=r(((t,r,n,d,s,c)=>(e.openBlock(),e.createBlock("div",o,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.waterfallList,((r,o)=>(e.openBlock(),e.createBlock("div",{key:o,class:"vue3-waterfall-item",style:{top:r.top+"px",left:r.left+"px",width:r.width+"px",height:r.height+"px"}},[e.renderSlot(t.$slots,"default",{item:r},(()=>[e.createVNode("img",{src:r.src,alt:r.title},null,8,["src","alt"]),e.createVNode("div",l,[e.renderSlot(t.$slots,"footer",{item:r},(()=>[e.createVNode("p",i,e.toDisplayString(r.title),1),e.createVNode("p",a,e.toDisplayString(r.info),1)]),!0)])]),!0)],4)))),128))]))));return t.render=n,t.__scopeId="data-v-4d34081c",t}));
