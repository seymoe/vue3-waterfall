var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,o)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,__spreadValues=(e,t)=>{for(var o in t||(t={}))__hasOwnProp.call(t,o)&&__defNormalProp(e,o,t[o]);if(__getOwnPropSymbols)for(var o of __getOwnPropSymbols(t))__propIsEnum.call(t,o)&&__defNormalProp(e,o,t[o]);return e};!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["vue3-waterfall"]=t(e.Vue)}(this,(function(e){"use strict";var t=e.defineComponent({name:"VueWaterfall",props:{width:Number,height:Number,colWidth:Number,cols:Number,gap:{type:Number,default:0},footerHeight:{type:Number,default:80},list:{type:Array,default:()=>[]}},setup(t){const o=e.reactive({containerWidth:t.width||0,colW:t.colWidth||240,colCount:t.cols||0,beginIndex:0,heightArr:[],waterfallList:[]}),r=()=>{if(!t.width){const e=document.querySelector("#waterfallBox");e&&(o.containerWidth=e.offsetWidth)}if(t.cols?o.colW=Math.floor(o.containerWidth/t.cols-t.gap):o.colCount=Math.floor(o.containerWidth/(o.colW+t.gap)),0===o.beginIndex){o.waterfallList=[],o.heightArr=new Array(o.colCount);for(let e=0;e<o.heightArr.length;e++)o.heightArr[e]=0}l()},l=()=>{for(let e=o.beginIndex;e<t.list.length;e++){const r=t.list[e];let l=new Image;l.src=r.imgSrc,l.onload=l.onerror=e=>{const n=i();r._width=o.colW,r._height=o.colW*l.height/l.width+t.footerHeight,r._top=o.heightArr[n],r._left=n*(r._width+t.gap),o.heightArr[n]+=r._height,o.waterfallList.push(r)}}o.beginIndex=o.waterfallList.length},i=()=>{const e=Math.min.apply(null,o.heightArr);return o.heightArr.indexOf(e)},n=()=>{o.beginIndex=0,r()};return e.watch((()=>t.list),((t,o)=>{(!o||!o.length&&t.length)&&e.nextTick((()=>{r()}))}),{immediate:!0}),e.onMounted((()=>{window.addEventListener("resize",n)})),e.onUnmounted((()=>{window.removeEventListener("resize",n)})),__spreadValues(__spreadValues({},e.toRefs(o)),e.toRefs(t))}});const o=e.withScopeId("data-v-011dc47e");e.pushScopeId("data-v-011dc47e");const r={class:"vue3-waterfall",id:"waterfallBox"},l={class:"vue3-waterfall-item_footer"},i={class:"title"},n={class:"info"};e.popScopeId();const a=o(((t,o,a,s,d,c)=>(e.openBlock(),e.createBlock("div",r,[(e.openBlock(!0),e.createBlock(e.Fragment,null,e.renderList(t.waterfallList,((o,r)=>(e.openBlock(),e.createBlock("div",{key:r,class:"vue3-waterfall-item",style:{top:o._top+"px",left:o._left+"px",width:o._width+"px",height:o._height+"px"}},[e.renderSlot(t.$slots,"default",{item:o},(()=>[e.createVNode("img",{src:o._src,alt:o.title},null,8,["src","alt"])]),!0),e.createVNode("div",l,[e.renderSlot(t.$slots,"footer",{item:o},(()=>[e.createVNode("p",i,e.toDisplayString(o.title),1),e.createVNode("p",n,e.toDisplayString(o.info),1)]),!0)])],4)))),128))]))));return t.render=a,t.__scopeId="data-v-011dc47e",t}));
